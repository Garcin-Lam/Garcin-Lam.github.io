---
title: 臺灣火災事件資料分析(一) - 動機 & 前處理踩雷
date: 2017-08-22
tags: [火警, 災害, 消防, 救護, 犯罪, GIS, 地理資訊系統, 資料視覺化, Pandas, 圖表技巧, 資料科學, 數據分析]
author: Lin, Kao-Yuan
---

<p align="center">
    <img src=/content/images/2017逢甲火災.JPG width=40% />
</p>

雖然最近幾年台灣政府吹起 open data 風，各界有許多大大致力於促進政府開放資料，造福這片土地上的芸芸眾生。例如各式各樣的等公車 App，讓我們可以很清楚掌握公車動向，使搭公車不再充滿不確定性的痛苦，提高了大眾運輸的使用率，間接促進環保和交通安全，這便是 open data 的好處。

只是，畢竟 open data 還是新興意識，許多政府單位對此還是扭扭捏捏，往往用個資法當作擋箭牌，只願意釋出統計過後的結論資料。在統計知識普及的時代，只要釋出原始事件資料，眾人力量往往能做出政府主計單位意想不到的成果。

由消防署提供的[火災事件資料](http://data.gov.tw/node/13764)就是一份很棒的 open data ，截至106.8.16，一共釋出了民國 103~104 年的資料，每一筆都是一個火災事件，保留了 [縣市, 鄉、鎮、市、區, 街、路段, 火災案件編號, 報案時間 (月：日：時：分) , 抵達時間 (月：日：時：分), 起火原因, 死亡人數, 受傷人數] 共 9 個維度，訊息含量相當豐富。

難得看到這麼好的資料，我就忍不住想要好好玩一下。

---
1. 資料合併
	- 各縣市都是獨立的 xls 檔案，但我要一次處理全國資料，所以需要把各縣市合併。

2. 資料清理
	- Noise 1：每個分頁的第 1 個 row 都是縣市名稱，第 2 個才開始是事件資料。
	- Noise 2：有一個檔案的 "縣市" 欄位同時出現高雄市和台南市，一看這個檔案的事件都和船有關，我才知道這個是「高雄港務消防隊」，是一個和縣市消防局同等級的單位。我服役的時候在這裡受訓，所以一看就知道。此處是高雄港管制區，但是入口在台南市。因為太過特殊且數量少，高雄港務消防隊在這次分析先不採用。

3. 補上缺失值
	- 單一維度的 key 發生碰撞：想要分析到「鄉鎮市區」的解析度，那「鄉鎮市區」可以直接當作和地圖的 merge key 嗎？不行！因為會有重複。例如：
		- "大安區" 台北市和台中市都有
		- "信義區" 台北市和基隆市都有  
	因此，必須用「縣市」+「鄉鎮市區」兩個 merge key 。
	- 缺字：「鄉鎮市區」這一欄的內容，字串結尾應該是「鄉鎮市區」的任一個字，但是卻找到以下資料例外
		- [中山', '七堵', '中正', '仁愛', '信義', '安樂', '暖暖', '臺西']
		所以還得自己補上區和鄉。
	- 將手動輸入資料屬性合併：各縣市消防局事件分類不一致，很多看起來都像是使用者自由輸入。有些感受到填表人員很盡力想忠實表達現場狀況，但這也讓資料被程式自動分類難度更高。只好把所有事件的火災原因都 unique 起來，用人工的方式，憑自己認知慢慢建立分組 dict（如下 code），程式就可以依照 dict 自動分類。火災資料還算少，如果是巨量資料，那就得靠 NLP（自然語言處理） 技術協助了。
	
	**因為我不是火災專家，這些分組歸類方式或許欠佳，歡迎網友點進去給我一些 comment**  
	<script src="https://gist.github.com/mosdeo/53245dd3894ff3ae7c2c3b5c316de806.js"></script>


	原本的火災事件總共有 62 類，但我們把敘述相似的字串正規化以後，最後只剩下 25 類了。
	```python
	原先所有類別數量 = 62
	關聯分組類別數量 = 25
	['乾燥作業' '交通事故' '其他或不明' '天然災害' '敬神掃墓祭祖' '敬神祭祖' '施工不慎' '易燃液體接觸火源' '機械設備'
	'汙泥過熱' '燃放爆竹煙火' '燃燒廢棄物' '爐火烹調' '玩火' '瓦斯' '縱火' '自殺' '菸蒂' '蠟燭' '車輛因素' '遺留火種'
	'除蜂不慎' '電暖器引燃可燃物' '電氣因素' '點蚊香不慎引火']
	```
到這裡，就可以開始把火災事件資料和臺灣地圖合併分析了！


## 104 年台灣火災原因排名
|電氣因素|縱火|其他或不明|菸蒂|遺留火種|爐火烹調|車輛因素|施工不慎|燃燒廢棄物|敬神祭祖|瓦斯|機械設備|燃放爆竹煙火|自殺|蠟燭|交通事故|易燃液體接觸火源|玩火|敬神掃墓祭祖|乾燥作業|汙泥過熱|除蜂不慎|電暖器引燃可燃物|天然災害|點蚊香不慎引火|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|576|270|164|148|104|72|46|37|31|31|29|27|26|24|19|18|15|14|14|2|1|1|1|1|1|

縱火居然是排名第2？出乎意料之外！
到底，縱火都發生在哪些地區呢？  

下一篇：<a href=http://mosdeo.github.io/2017/08/28/%E8%87%BA%E7%81%A3%E7%81%AB%E7%81%BD%E4%BA%8B%E4%BB%B6%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90(%E4%BA%8C)>臺灣火災事件資料分析(二) - 縱火案件數量地圖</a>


**markdown render test**  
下一篇：[臺灣火災事件資料分析(二) - 縱火案件數量地圖](http://mosdeo.github.io/2017/08/28/%E8%87%BA%E7%81%A3%E7%81%AB%E7%81%BD%E4%BA%8B%E4%BB%B6%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90(%E4%BA%8C))

<br>
<br>	 
關於作者： 
[@LKY](http://web.ntnu.edu.tw/~60132057A/) 自認不夠資格叫作 Data Scientist 的資料科學工程師，最近關注救災、救護相關的 Open Data。  
